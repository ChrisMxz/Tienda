<?xml version="1.0" encoding="ISO-8859-1" ?>

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

	<div class="card">
		<h:form id="formulario-pedido">

			<p:outputPanel class="formgrid grid" id="detalles"
				rendered="#{pedidoBean.formularioActivo}">

				<!-- divider con titulo -->
				<p:divider align="left">
					<div class="inline-flex align-items-center">
						<b> <p:outputLabel value="Pedido" />
						</b>
					</div>
				</p:divider>

				<div class="field col-12">
					<p:staticMessage severity="info" summary="Fecha de Registro:"
						styleClass="text-xs p-1"
						detail="#{pedidoBean.pedidoSeleccionado.fechaPedido}"
						rendered="#{pedidoBean.pedidoSeleccionado.fechaPedido!=null}" />
				</div>
				<div class="field col-12">
					<p:staticMessage severity="info" summary="Estatus"
						styleClass="text-xs p-1"
						detail="#{pedidoBean.pedidoSeleccionado.estatus}"
						rendered="#{pedidoBean.pedidoSeleccionado.estatus!=null}" />
				</div>
				<!-- Input Cliente -->
				<div class="field col-12 md:col-12">
					<p:outputLabel for="@next" value="Cliente" />
					<p:message for="@next" display="text"
						styleClass="text-xs pl-0 py-1 border-none" />
					<p:selectOneMenu value="#{pedidoBean.pedidoSeleccionado.cliente}"
						id="seleccion-cliente" filter="true" filterMatchMode="startsWith"
						required="true" requiredMessage="Elige un cliente"
						rendered="#{pedidoBean.pedidoSeleccionado.cliente.nivel!=1}">
						<f:selectItem itemLabel="Seleccionar " Value="#{null}" />
						<f:selectItems value="#{usuarioBean.listaUsuarios}" var="cliente"
							itemLabel="#{cliente.nombre}" />
						<f:converter binding="#{clienteConverter}" />
					</p:selectOneMenu>
				</div>

				<!-- Lista de items del pedido -->
				<ui:include src="/resources/paginas/pedidos/listaItems.xhtml" />
			</p:outputPanel>


		</h:form>

		<h:form id="formulario-items">
			<!-- Dialogo modal para mostrar los detalles del item -->
			<p:dialog header="Categoria" widgetVar="dialogoItemsForm"
				minHeight="230" minWidth="250" width="500" height="280"
				responsive="true" showEffect="fade" modal="true" hideEffect="fade"
				closeOnEscape="true">

				<ui:include src="/resources/paginas/pedidos/formularioItem.xhtml" />

				<f:facet name="footer">
					<p:commandButton id="btn-agregar" icon="pi pi-save" value="Guardar"
						validateClient="true" update=":formulario-items:itemPanel"
						actionListener="#{itemBean.guardar}"
						styleClass="ui-button-primary rounded-button">
					</p:commandButton>

				</f:facet>

			</p:dialog>

		</h:form>


	</div>
</ui:composition>